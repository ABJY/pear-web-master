@using Microsoft.AspNet.Identity
@model NTU_FYP_REBUILD_17.ViewModels.GameTherapistOverviewViewModel

@{
    ViewBag.Title = "View Patient";
    Layout = "~/Views/Shared/_LayoutGameTherapist.cshtml";

    if (ViewBag.Modal == "true")
    {
        <script type="text/javascript">
            $(window).on('load', function () {
                $('#MyModal').modal('show');
            });
        </script>
    }
}

<style>
    .forscroll {
        width: 100%;    
        max-height: 300px;
        overflow-y: scroll;
    }

    .row > .column {
        padding: 0 8px;
    }

    .row:after {
        content: "";
        display: table;
        clear: both;
    }
    /* Create four equal columns that floats next to eachother */
    .column {
        float: left;
        width: 20%;
    }
    /* The Modal (background) */
    .modal2 {
        display: none;
        position: fixed;
        z-index: 1;
        padding-top: 100px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: black;
    }
    /* Modal Content */
    .modal2-content {
        position: relative;
        background-color: #fefefe;
        margin: auto;
        padding: 0;
        width: 90%;
        max-width: 500px;
    }
    /* The Close Button */
    .close2 {
        color: white;
        position: absolute;
        top: 10px;
        right: 25px;
        font-size: 35px;
        font-weight: bold;
    }

        .close2:hover,
        .close2:focus {
            color: #999;
            text-decoration: none;
            cursor: pointer;
        }
    /* Hide the slides by default */
    .mySlides {
        display: none;
    }

    /* Next & previous buttons
    .prev,
    .next {
        cursor: pointer;
        position: absolute;
        top: 50%;
        width: auto;
        padding: 16px;
        margin-top: -50px;
        color: white;
        font-weight: bold;
        font-size: 20px;
        transition: 0.6s ease;
        border-radius: 0 3px 3px 0;
        user-select: none;
        -webkit-user-select: none;
    }
    Position the "next button" to the right
    .next {
        right: 0;
        border-radius: 3px 0 0 3px;
    }
    On hover, add a black background color with a little bit see-through
    .prev:hover,
    .next:hover {
        background-color: rgba(0, 0, 0, 0.8);
    }
    /* Number text (1/3 etc) */
    .numbertext {
        color: #f2f2f2;
        font-size: 12px;
        padding: 8px 12px;
        position: absolute;
        top: 0;
    }
    /* Caption text */
    .caption-container {
        text-align: center;
        background-color: black;
        padding: 2px 16px;
        color: white;
    }

    close img.demo {
        opacity: 0.6;
    }

    .active,
    .demo:hover {
        opacity: 1;
    }

    img.hover-shadow {
        transition: 0.3s;
    }

    .hover-shadow:hover {
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    }

    #imageTitle1 {
        display: inline-block;
        margin-left: 120px;
        margin-right: 30px;
    }

    #imageUpload1 {
        display: inline-block;
        margin-right: 30px;
    }

    .weekDays-selector input {
        display: none !important;
    }

        .weekDays-selector input[type=checkbox] + label {
            display: inline-block;
            border-radius: 6px;
            background: #dddddd;
            height: 40px;
            width: 40px;
            margin-right: 3px;
            line-height: 40px;
            text-align: center;
            cursor: pointer;
        }

        .weekDays-selector input[type=checkbox]:checked + label {
            background: #000;
            color: #ffffff;
        }
</style>

<link href="~/Content/global/plugins/bootstrap-daterangepicker/daterangepicker.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/clockface/css/clockface.css" rel="stylesheet" type="text/css" />

<div class="portlet light ">
    <div class="portlet-title tabbable-line">
        <div class="caption caption-md">
            <i class="icon-globe theme-font hide"></i>
            <span class="caption-subject font-blue-madison bold uppercase">@Model.patient.preferredName's profile</span>
        </div>
    </div>
    <div class="portlet-body">
        <div class="portlet light ">
            <div class="portlet-body">
                @Html.HiddenFor(p => p.patient.patientID, new { @Value = @Model.patient.patientID, @id = "a1" })
                <div class="tabbable-line tabbable-full-width">
                    <!--<ul class="nav nav-tabs">
                        <li class="active">
                            <a href="#tab_1_1" data-toggle="tab"> Overview</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tab_1_1">-->
                    <div class="row">
                        <div class="col-md-3" style="width:20%; text-align:center">
                            <ul class="list-unstyled profile-nav">
                                <li>
                                    <img src="@Model.imageUrl" class="img-responsive pic-bordered" alt="" width="400" height="400" />
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-9">
                            <div class="row">
                                <div class="col-md-6 profile-info">
                                    <h1 class="font-green sbold uppercase">Patient - @Model.patient.firstName @Model.patient.lastName</h1>
                                    <ul class="list-inline">
                                        @if (@Model.patient.gender == "M")
                                        {
                                            <li>
                                                <i class="fa fa-male"></i> Male
                                            </li>
                                        }
                                        else
                                        {
                                            <li>
                                                <i class="fa fa-female"></i> Female
                                            </li>
                                        }

                                        <li>
                                            <i class="fa fa-credit-card"></i>@Model.patient.maskedNric
                                        </li>
                                        <li>
                                            <i class="fa fa-calendar"></i> @Model.patient.DOB.ToString(String.Format("dd/MM/yyyy"))
                                        </li>
                                        @if (@Model.patient.handphoneNo != null)
                                        {
                                            <li>
                                                <i class="fa fa-mobile-phone"></i> @Model.patient.handphoneNo
                                            </li>
                                        }
                                        else if (@Model.patient.homeNo != null)
                                        {
                                            <li>
                                                <i class="fa fa-home"></i> @Model.patient.homeNo
                                            </li>
                                        }
                                        @if (Model.patientLanguage != null)
                                        {
                                            <li>
                                                <i class="fa fa-language"></i> @Model.patientLanguage
                                            </li>
                                        }
                                    </ul>
                                </div>
                                @if (Model.mainGuardian != null)
                                {
                                    <div class="col-md-6 profile-info">
                                        <h1 class="font-green sbold uppercase">Main Guardian - @Model.mainGuardian.firstName @Model.mainGuardian.lastName</h1>
                                        <ul class="list-inline">
                                            @if (@Model.mainGuardian.gender == "M")
                                            {
                                                <li>
                                                    <i class="fa fa-male"></i> Male
                                                </li>
                                            }
                                            else
                                            {
                                                <li>
                                                    <i class="fa fa-female"></i> Female
                                                </li>
                                            }
                                            <li>
                                                <i class="fa fa-envelope"></i> @Model.mainGuardian.Email
                                            </li>
                                            <li>
                                                <i class="fa fa-mobile-phone"></i> @Model.mainGuardian.PhoneNumber
                                            </li>
                                            <li>
                                                <i class="fa fa-user"></i> @Model.mainGuardianRelationship
                                            </li>
                                        </ul>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="col-md-9" style="width:80%">
                            <div class="tabbable-line tabbable-custom-profile">
                                <div class="portlet light portlet-fit ">
                                    <div class="tabbable-line tabbable-custom-profile">
                                        <ul class="nav nav-tabs">
                                            <li class="@ViewBag.Info">
                                                <a href="#tab_1_11" data-toggle="tab"> Information </a>
                                            </li>
                                            <li class="@ViewBag.History">
                                                <a href="#tab_1_22" data-toggle="tab"> History </a>
                                            </li>
                                            <li class="@ViewBag.GameList">
                                                <a href="#tab_1_33" data-toggle="tab"> List of Recommended Games</a>
                                            </li>
                                        </ul>
                                        <div class="tab-content">
                                            <div class="tab-pane @ViewBag.Info" id="tab_1_11">
                                                <div class="portlet-body">
                                                    <div class="portlet light">
                                                        <div class="portlet-body">
                                                            <div class="portlet light portlet-fit ">
                                                                <div class="portlet-title">
                                                                    <div class="caption">
                                                                        <i class="fa fa-gamepad font-red"></i>
                                                                        <span class="caption-subject font-red sbold uppercase">Information</span>
                                                                    </div>
                                                                </div>
                                                                <div class="portlet-body">
                                                                    <div>
                                                                        <table class="table table-hover table-light">
                                                                            <thead>
                                                                                <tr>
                                                                                    <TD align="left" valign="top" width="50%">
                                                                                        <table cellpadding="3%">
                                                                                            <tr>
                                                                                                <td>First Name <b>@Model.patient.firstName</b></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>Last Name <b>@Model.patient.lastName</b></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>Preferred Name <b>@Model.patient.preferredName</b></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                @if (Model.patient.gender == "M")
                                                                                                {
                                                                                                    <td>Gender <b> Male </b></td>
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    <td>Gender <b> Female </b></td>
                                                                                                }
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>NRIC <b>@Model.patient.maskedNric</b></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>Date of Birth <b>@Model.patient.DOB.ToString("dd/MM/yyyy")</b></td>
                                                                                            </tr>
                                                                                            @if (Model.patientLanguage != null)
                                                                                            {
                                                                                                <tr>
                                                                                                    <td>Preferred Lanuage <b>@Model.patientLanguage</b></td>
                                                                                                </tr>
                                                                                            }
                                                                                            <tr></tr>
                                                                                        </table>
                                                                                    </TD>
                                                                                    <TD align="left" valign="top" width="50%">
                                                                                        <table cellpadding="3%">
                                                                                            <tr>
                                                                                                <td>Handphone No <b>@Model.patient.handphoneNo</b></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>&nbsp;</td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>Start Date <b>@Model.patient.startDate.ToString("dd/MM/yyyy")</b></td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>
                                                                                                    End Date
                                                                                                    @if (Model.patient.endDate != null)
                                                                                                    {
                                                                                                        <b>@(((DateTime)Model.patient.endDate).ToString("dd/MM/yyyy"))</b>
                                                                                                    }
                                                                                                </td>
                                                                                            </tr>
                                                                                            <tr>
                                                                                                <td>
                                                                                                    Inactive Date
                                                                                                    @if (Model.patient.inactiveDate != null)
                                                                                                    {
                                                                                                        <b>@(((DateTime)Model.patient.inactiveDate).ToString("dd/MM/yyyy"))</b>
                                                                                                    }
                                                                                                </td>
                                                                                            </tr>
                                                                                        </table>
                                                                                    </TD>
                                                                                </tr>
                                                                            </thead>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="portlet light portlet-fit ">
                                                                <div class="portlet-title">
                                                                    <div class="caption">
                                                                        <i class="fa fa-file-text-o font-red"></i>
                                                                        <span class="caption-subject font-red sbold uppercase">Diagnosed Dementia</span>
                                                                    </div>
                                                                </div>
                                                                <div class="portlet-body forscroll">
                                                                    <div class="table-scrollable table-scrollable-borderless">
                                                                        <table class="table table-hover table-light">
                                                                            <thead>
                                                                                <tr class="uppercase">
                                                                                    <th> No </th>
                                                                                    <th> Dementia Type </th>
                                                                                    <th> Diagnosed Date </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                @foreach (var i in Model.diagnosedDementia.Select((value, index) => new { index, value }))
                                                                                {
                                                                                    <tr>
                                                                                        <td>@( i.index + 1 )</td>
                                                                                        <td>@i.value.dementia.dementiaType</td>
                                                                                        <td>@i.value.pad.createdDateTime.ToString("dd/MM/yyyy")</td>
                                                                                    </tr>
                                                                                }
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="portlet light portlet-fit ">
                                                                <div class="portlet-title">
                                                                    <div class="caption">
                                                                        <i class="fa fa-file-text-o font-red"></i>
                                                                        <span class="caption-subject font-red sbold uppercase">Mobility Aids</span>
                                                                    </div>
                                                                </div>
                                                                <div class="portlet-body forscroll">
                                                                    <div class="table-scrollable table-scrollable-borderless">
                                                                        <table class="table table-hover table-light">
                                                                            <thead>
                                                                                <tr class="uppercase">
                                                                                    <th> No </th>
                                                                                    <th> Mobility Aids </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                @foreach (var i in Model.mobility.Select((value, index) => new { index, value }))
                                                                                {
                                                                                    <tr>
                                                                                        <td>@( i.index + 1 )</td>
                                                                                        <td>@i.value.mobilityType</td>
                                                                                    </tr>
                                                                                }
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="portlet light portlet-fit ">
                                                                <div class="portlet-title">
                                                                    <div class="caption">
                                                                        <i class="fa fa-file-text-o font-red"></i>
                                                                        <span class="caption-subject font-red sbold uppercase">Assigned Games</span>
                                                                    </div>
                                                                </div>
                                                                <div class="portlet-body forscroll">
                                                                    <div class="table-scrollable table-scrollable-borderless">
                                                                        <table class="table table-hover table-light">
                                                                            <thead>
                                                                                <tr class="uppercase">
                                                                                    <th> No </th>
                                                                                    <th> Game Title </th>
                                                                                    <th> Category </th>
                                                                                    <th> Game Therapist </th>
                                                                                    <th> Status </th>
                                                                                    <th> Assigned Date </th>
                                                                                    <th> End Date </th>
                                                                                    <th></th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                @foreach (var i in Model.game.Select((value, index) => new { index, value }))
                                                                                {
                                                                                    <tr>
                                                                                        <td>@( i.index + 1 )</td>
                                                                                        <td>@i.value.game.gameName</td>
                                                                                        <td>@i.value.gameCategory</td>
                                                                                        <td>@i.value.gameTherapistName <a class="fa fa-info-circle" data-toggle="desc" title="Recommendation reason: @i.value.assignedGame.recommmendationReason"></a></td>
                                                                                        @if (i.value.assignedGame.isApproved == 1)
                                                                                        {
                                                                                            <td>Approved</td>
                                                                                        }
                                                                                        else if (i.value.assignedGame.isApproved == 0)
                                                                                        {
                                                                                            <td>Rejected <a class="fa fa-info-circle" data-toggle="desc" title="Rejection reason: @i.value.assignedGame.rejectionReason"></a></td>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td>Pending</td>
                                                                                        }
                                                                                        <td>@i.value.assignedGame.createDateTime.ToString("dd/MM/yyyy")</td>
                                                                                        @if (i.value.assignedGame.endDate != null)
                                                                                        {
                                                                                            <td>@(((DateTime)i.value.assignedGame.endDate).ToString("dd/MM/yyyy"))</td>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td></td>
                                                                                        }
                                                                                        @*<td><a id="@i.value.assignedGame.assignedGameID" class="btn dark btn-sm btn-outline sbold uppercase red" data-target="#MyModal4" data-toggle="modal" onclick="OpenModalAssignedGame('@i.value.game.gameName', '@i.value.gameCategory', this.id);"><i class="fa fa-edit"></i> Edit </a></td>*@
                                                                                    </tr>
                                                                                }
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                                <div style="text-align:center">
                                                                    <a class="btn green btn-outline sbold uppercase" data-target="#addAssignedGame" data-toggle="modal"><i class="fa fa-plus"></i> Add Game </a>
                                                                </div>
                                                                <hr />
                                                            </div>
                                                            <div class="portlet light portlet-fit ">
                                                                <div class="portlet-title">
                                                                    <div class="caption">
                                                                        <i class="fa fa-file-text-o font-red"></i>
                                                                        <span class="caption-subject font-red sbold uppercase">Game Played</span>
                                                                    </div>
                                                                </div>
                                                                <div class="portlet-body forscroll">
                                                                    <div class="table-scrollable table-scrollable-borderless">
                                                                        <table class="table table-hover table-light">
                                                                            <thead>
                                                                                <tr class="uppercase">
                                                                                    <th> No </th>
                                                                                    <th> Game Title </th>
                                                                                    <th> Score </th>
                                                                                    <th> Time Taken (in seconds) </th>
                                                                                    <th> Date </th>
                                                                                    <th> Time </th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                @foreach (var i in Model.gameRecordList.Select((value, index) => new { index, value }))
                                                                                {
                                                                                    <tr>
                                                                                        <td>@( i.index + 1 )</td>
                                                                                        <td>@i.value.gameName</td>
                                                                                        <td>@i.value.gameRecord.score</td>
                                                                                        <td>@i.value.gameRecord.timeTaken</td>
                                                                                        <td>@i.value.gameRecord.createDateTime.ToString("dd/MM/yyyy ")</td>
                                                                                        <td>@i.value.gameRecord.createDateTime.ToString("HH:mm")</td>
                                                                                    </tr>
                                                                                }
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            @if (Model.allowGame == true)
                                                            {
                                                                <div class="portlet light portlet-fit ">
                                                                    <div class="portlet-title">
                                                                        <div class="caption">
                                                                            <i class="fa fa-file-text-o font-red"></i>
                                                                            <span class="caption-subject font-red sbold uppercase">Recommended Game Category</span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="portlet-body forscroll">
                                                                        <div class="table-scrollable table-scrollable-borderless">
                                                                            <table class="table table-hover table-light">
                                                                                <thead>
                                                                                    <tr class="uppercase">
                                                                                        <th> No </th>
                                                                                        <th> Category </th>
                                                                                        <th> Start Date </th>
                                                                                        <th> End Date </th>
                                                                                        <th> Recommender </th>
                                                                                        <th> Status </th>
                                                                                        <th></th>
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody>
                                                                                    @foreach (var i in Model.gameRecommended.Select((value, index) => new { index, value }))
                                                                                    {
                                                                                        <tr>
                                                                                            <td>@( i.index + 1 )</td>
                                                                                            <td>@i.value.gameCategory.categoryName</td>
                                                                                            <td>@i.value.gamesTypeRecommendation.startDate.ToString("dd/MM/yyyy")</td>
                                                                                            @if (i.value.gamesTypeRecommendation.endDate != null)
                                                                                            {
                                                                                                <td>@(((DateTime)i.value.gamesTypeRecommendation.endDate).ToString("dd/MM/yyyy"))</td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td></td>
                                                                                            }
                                                                                            
                                                                                            @if (i.value.doctorName != null)
                                                                                            {
                                                                                                <td>Dr. @i.value.doctorName <a class="fa fa-info-circle" data-toggle="desc" title="Recommendation reason: @i.value.gamesTypeRecommendation.recommmendationReason"></a></td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>GT @i.value.gameTherapistName <a class="fa fa-info-circle" data-toggle="desc" title="Recommendation reason: @i.value.gamesTypeRecommendation.recommmendationReason"></a></td>
                                                                                            }
                                                                                            @if (i.value.gamesTypeRecommendation.isApproved == 1)
                                                                                            {
                                                                                                <td>Approved</td>
                                                                                            }
                                                                                            else if (i.value.gamesTypeRecommendation.isApproved == 0)
                                                                                            {
                                                                                                <td>Rejected by supervisor <a class="fa fa-info-circle" data-toggle="desc" title="Rejection reason: @i.value.gamesTypeRecommendation.rejectionReason"></a></td>
                                                                                            }
                                                                                            else if (i.value.gamesTypeRecommendation.gameTherapistApproved == 2)
                                                                                            {
                                                                                                <td>Pending approval from game therapist</td>
                                                                                            }
                                                                                            else if (i.value.gamesTypeRecommendation.gameTherapistApproved == 0)
                                                                                            {
                                                                                                <td>Rejected by game therapist <a class="fa fa-info-circle" data-toggle="desc" title="Rejection reason: @i.value.gamesTypeRecommendation.rejectionReason"></a></td>
                                                                                            }
                                                                                            else if (i.value.gamesTypeRecommendation.supervisorApproved == 0)
                                                                                            {
                                                                                                <td>Rejected by supervisor <a class="fa fa-info-circle" data-toggle="desc" title="Rejection reason: @i.value.gamesTypeRecommendation.rejectionReason"></a></td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td>Pending approval from supervisor</td>
                                                                                            }
                                                                                            @if (i.value.allowRespond == 1)
                                                                                            {
                                                                                                <td><a id="@i.value.gamesTypeRecommendation.gamesTypeRecommendationID" class="btn dark btn-sm btn-outline sbold uppercase red" data-target="#MyModal2" data-toggle="modal" onclick="OpenModalApproveReject('@i.value.gameCategory.categoryName', '@i.value.doctorName', '@i.value.gamesTypeRecommendation.endDate', '@i.value.gamesTypeRecommendation.recommmendationReason', this.id);"><i class="fa fa-edit"></i> Approve/Reject </a></td>
                                                                                            }
                                                                                        </tr>
                                                                                    }
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </div>
                                                                    <div style="text-align:center">
                                                                        <a class="btn green btn-outline sbold uppercase" data-target="#addGameRecommended" data-toggle="modal"><i class="fa fa-plus"></i> Recommend Game Category </a>
                                                                    </div>
                                                                    <hr />
                                                                </div>
                                                            }
                                                            <div class="portlet light portlet-fit ">
                                                                <div class="portlet-title">
                                                                    <div class="caption">
                                                                        <i class="fa fa-file-text-o font-red"></i>
                                                                        <span class="caption-subject font-red sbold uppercase">Staff Allocation</span>
                                                                    </div>
                                                                </div>
                                                                <div class="portlet-body">
                                                                    <div class="table-scrollable table-scrollable-borderless">
                                                                        <table class="table table-hover table-light">
                                                                            <thead>
                                                                                <tr class="uppercase">
                                                                                    <th> Staff Role </th>
                                                                                    <th> Staff Name </th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                @foreach (var i in Model.staffAllocation)
                                                                                {
                                                                                    <tr>
                                                                                        <td>@i.staffRole</td>
                                                                                        <td>@i.staffName</td>
                                                                                    </tr>
                                                                                }
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tab-pane @ViewBag.History" id="tab_1_22">
                                                <div class="portlet light portlet-fit ">
                                                    <div class="portlet-title">
                                                        <div class="caption">
                                                            <i class="fa fa-file-text-o font-red"></i>
                                                            <span class="caption-subject font-red sbold uppercase">Social History</span>
                                                        </div>
                                                    </div>
                                                    <div class="portlet-body">
                                                        <div class="table-scrollable table-scrollable-borderless">
                                                            <table class="table table-hover table-light">
                                                                <thead>
                                                                    <tr>
                                                                        <TD align="left" valign="top" width="30%">
                                                                            <table class="table table-hover table-light">
                                                                                @if (@Model.socialHistory.alcoholUse != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Alcohol Use</td>
                                                                                        <td><b>@Model.socialHistory.alcoholUse</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.caffeineUse != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Caffeine Use</td>
                                                                                        <td><b>@Model.socialHistory.caffeineUse</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.drugUse != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Drug Use</td>
                                                                                        <td><b>@Model.socialHistory.drugUse</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.exercise != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Exercise</td>
                                                                                        <td><b>@Model.socialHistory.exercise</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.retired != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Retired</td>
                                                                                        <td><b>@Model.socialHistory.retired</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.tobaccoUse != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Tobacco Use</td>
                                                                                        <td><b>@Model.socialHistory.tobaccoUse</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.secondhandSmoker != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Secondhand Smoker</td>
                                                                                        <td><b>@Model.socialHistory.secondhandSmoker</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.sexuallyActive != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Sexually Active</td>
                                                                                        <td><b>@Model.socialHistory.sexuallyActive</b></td>
                                                                                    </tr>
                                                                                }
                                                                            </table>
                                                                        </TD>
                                                                        <TD align="left" valign="top" width="20%"></TD>
                                                                        <TD align="left" valign="top" width="30%">
                                                                            <table class="table table-hover table-light">
                                                                                @if (@Model.socialHistory.diet != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Diet</td>
                                                                                        <td><b>@Model.socialHistory.diet</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.education != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Education</td>
                                                                                        <td><b>@Model.socialHistory.education</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.liveWith != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Live With</td>
                                                                                        <td><b>@Model.socialHistory.liveWith</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.occupation != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Occupation</td>
                                                                                        <td><b>@Model.socialHistory.occupation</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.pet != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Pet</td>
                                                                                        <td><b>@Model.socialHistory.pet</b></td>
                                                                                    </tr>
                                                                                }
                                                                                @if (@Model.socialHistory.religion != null)
                                                                                {
                                                                                    <tr>
                                                                                        <td>Religion</td>
                                                                                        <td><b>@Model.socialHistory.religion</b></td>
                                                                                    </tr>
                                                                                }
                                                                            </table>
                                                                        </TD>
                                                                    </tr>
                                                                </thead>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    @if (Model.dislike != null)
                                                    {
                                                        <div class="portlet light portlet-fit ">
                                                            <div class="portlet-title">
                                                                <div class="caption">
                                                                    <i class="fa fa-file-text-o font-red"></i>
                                                                    <span class="caption-subject font-red sbold uppercase">Dislikes</span>
                                                                </div>
                                                            </div>
                                                            <div class="portlet-body forscroll">
                                                                <div class="table-scrollable table-scrollable-borderless">
                                                                    <table class="table table-hover table-light">
                                                                        <thead>
                                                                            <tr class="uppercase">
                                                                                <th> No </th>
                                                                                <th> Dislike Item </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @foreach (var i in Model.dislike.Select((value, index) => new { index, value }))
                                                                            {
                                                                                <tr>
                                                                                    <td>@( i.index + 1 )</td>
                                                                                    <td>@i.value.dislikeItem</td>
                                                                                </tr>
                                                                            }
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    @if (Model.habit != null)
                                                    {
                                                        <div class="portlet light portlet-fit ">
                                                            <div class="portlet-title">
                                                                <div class="caption">
                                                                    <i class="fa fa-file-text-o font-red"></i>
                                                                    <span class="caption-subject font-red sbold uppercase">Habits</span>
                                                                </div>
                                                            </div>
                                                            <div class="portlet-body forscroll">
                                                                <div class="table-scrollable table-scrollable-borderless">
                                                                    <table class="table table-hover table-light">
                                                                        <thead>
                                                                            <tr class="uppercase">
                                                                                <th> No </th>
                                                                                <th> Habit </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @foreach (var i in Model.habit.Select((value, index) => new { index, value }))
                                                                            {
                                                                                <tr>
                                                                                    <td>@( i.index + 1 )</td>
                                                                                    <td>@i.value.habitItem</td>
                                                                                </tr>
                                                                            }
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    @if (Model.hobby != null)
                                                    {
                                                        <div class="portlet light portlet-fit ">
                                                            <div class="portlet-title">
                                                                <div class="caption">
                                                                    <i class="fa fa-file-text-o font-red"></i>
                                                                    <span class="caption-subject font-red sbold uppercase">Hobbies</span>
                                                                </div>
                                                            </div>
                                                            <div class="portlet-body forscroll">
                                                                <div class="table-scrollable table-scrollable-borderless">
                                                                    <table class="table table-hover table-light">
                                                                        <thead>
                                                                            <tr class="uppercase">
                                                                                <th> No </th>
                                                                                <th> Hobby </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @foreach (var i in Model.hobby.Select((value, index) => new { index, value }))
                                                                            {
                                                                                <tr>
                                                                                    <td>@( i.index + 1 )</td>
                                                                                    <td>@i.value.hobbyItem</td>
                                                                                </tr>
                                                                            }
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    @if (Model.holiday != null)
                                                    {
                                                        <div class="portlet light portlet-fit ">
                                                            <div class="portlet-title">
                                                                <div class="caption">
                                                                    <i class="fa fa-file-text-o font-red"></i>
                                                                    <span class="caption-subject font-red sbold uppercase">Holiday Experiences</span>
                                                                </div>
                                                            </div>
                                                            <div class="portlet-body forscroll">
                                                                <div class="table-scrollable table-scrollable-borderless">
                                                                    <table class="table table-hover table-light">
                                                                        <thead>
                                                                            <tr class="uppercase">
                                                                                <th> No </th>
                                                                                <th> Country </th>
                                                                                <th> Photo </th>
                                                                                <th> Experience </th>
                                                                                <th> Start Date </th>
                                                                                <th> End Date </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @foreach (var i in Model.holiday.Select((value, index) => new { index, value }))
                                                                            {
                                                                                <tr>
                                                                                    <td>@( i.index + 1 )</td>
                                                                                    <td>@i.value.country</td>

                                                                                    @if (i.value.holidayExperience.albumPatientID != null)
                                                                                    {
                                                                                        <td><img src="@i.value.albumPath" width="30" height="30" onclick="openModal('Holiday Expereience', '@i.value.albumPath')" class="hover-shadow"></td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td></td>
                                                                                    }

                                                                                    <td>@i.value.holidayExperience.holidayExp</td>
                                                                                    @if (i.value.holidayExperience.startDate != null)
                                                                                    {
                                                                                        <td>@(((DateTime)i.value.holidayExperience.startDate).ToString("dd/MM/yyyy"))</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td></td>
                                                                                    }
                                                                                    @if (i.value.holidayExperience.endDate != null)
                                                                                    {
                                                                                        <td>@(((DateTime)i.value.holidayExperience.endDate).ToString("dd/MM/yyyy"))</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td></td>
                                                                                    }
                                                                                </tr>
                                                                            }
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                    @if (Model.like != null)
                                                    {
                                                        <div class="portlet light portlet-fit ">
                                                            <div class="portlet-title">
                                                                <div class="caption">
                                                                    <i class="fa fa-file-text-o font-red"></i>
                                                                    <span class="caption-subject font-red sbold uppercase">Likes</span>
                                                                </div>
                                                            </div>
                                                            <div class="portlet-body forscroll">
                                                                <div class="table-scrollable table-scrollable-borderless">
                                                                    <table class="table table-hover table-light">
                                                                        <thead>
                                                                            <tr class="uppercase">
                                                                                <th> No </th>
                                                                                <th> Like Item </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @foreach (var i in Model.like.Select((value, index) => new { index, value }))
                                                                            {
                                                                                <tr>
                                                                                    <td>@( i.index + 1 )</td>
                                                                                    <td>@i.value.likeItem</td>
                                                                                </tr>
                                                                            }
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                </div>
                                            </div>
                                            <div class="tab-pane @ViewBag.GameList" id="tab_1_33">
                                                <div class="portlet light portlet-fit ">
                                                    <div class="portlet-title">
                                                        <div class="caption">
                                                            <i class="fa fa-file-text-o font-red"></i>
                                                            <span class="caption-subject font-red sbold uppercase">Recommended Game via Recommended Game Category for Patient</span>
                                                        </div>
                                                    </div>
                                                    <div class="portlet-body">
                                                        @using (Html.BeginForm("AddGameForPatient", "GameTherapist", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                                                        {
                                                            @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                                                            <div class="table-scrollable table-scrollable-borderless">
                                                                <table class="table table-hover table-light">
                                                                    <thead>
                                                                        <tr class="uppercase">
                                                                            <th></th>
                                                                            <th><input type="checkbox" onclick="checkAllGamePatient(this)" /> Select All</th>
                                                                            @for (int j = 0; j < Model.gameAssignedPatientViewModel.recommendedCategory.Count; j++)
                                                                            {
                                                                                <th>
                                                                                    @Model.gameCategoryList[j]
                                                                                    @if (Model.gameAssignedPatientViewModel.recommendedCategory[j] == "Yes")
                                                                                    {
                                                                                        <i class="fa fa-thumbs-up fa fa-lg space text-success"></i>
                                                                                    }
                                                                                </th>
                                                                            }
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @foreach (var i in Model.gameAssignedPatientViewModel.viewModel.Select((value, index) => new { index, value }))
                                                                        {
                                                                            @Html.HiddenFor(m => m.assignPatientViewModel[i.index].gameName, new { @Value = @Model.gameAssignedPatientViewModel.viewModel[i.index].game.gameName, @id = "gameName" + i.index })
                                                                            if (i.value.showGame == true)
                                                                            {
                                                                                <tr>
                                                                                    <td>@i.value.game.gameName <a class="fa fa-info-circle" data-toggle="desc" title="Categories: @i.value.categoryList"></a></td>
                                                                                    @if (i.value.gameAlreadyAssigned == true)
                                                                                    {
                                                                                        <td>@Html.CheckBoxFor(m => m.assignPatientViewModel[i.index].gameChecked, new { @id = "oldGamePatient" + i.index, @checked = "checked", @disabled = "disabled" })</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        @Html.HiddenFor(m => m.assignPatientViewModel[i.index].gameID, new { @Value = @Model.gameAssignedToDementia[i.index].game.gameID, @id = "gamePatientID" + i.index })
                                                                                        <td>@Html.CheckBoxFor(m => i.value.gameAlreadyAssigned, new { Name = "gamePatientCheckBox", @id = "oldGamePatient" + i.index, @checked = i.value.gameAlreadyAssigned })</td>
                                                                                        @:&nbsp;
                                                                                        @Html.HiddenFor(m => m.assignPatientViewModel[i.index].gameChecked, new { @Value = "", @id = "newGamePatient" + i.index })
                                                                                    }
                                                                                    @foreach (var j in i.value.categoryBitString)
                                                                                    {
                                                                                        if (@j == "Yes")
                                                                                        {
                                                                                            <td><i class="fa fa-lg fa-check space text-success"></i></td>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td><i class="fa fa-lg fa-times space text-danger"></i></td>
                                                                                        }
                                                                                    }
                                                                                </tr>
                                                                            }
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <hr />
                                                            <div class="form-body">
                                                                <div class="form-group form-md-line-input has-success">
                                                                    <label class="col-md-2 control-label" for="form_control_1">End Date </label>
                                                                    <div class="col-md-10">
                                                                        @Html.TextBoxFor(m => m.gameCategoryEndDate, "dd/mm/yyyy", new { @class = "form-control date-picker", id = "datetimepicker3", @data_date_format = "dd/mm/yyyy" })
                                                                        <div class="form-control-focus"> </div>
                                                                        <span style="display: none; color:red;" id="gameCategoryDateError"></span>
                                                                    </div>
                                                                    <label class="col-md-2 control-label" for="form_control_1">Reason <a style="color:red; font-size:large">*</a></label>
                                                                    <div class="col-md-10">
                                                                        @Html.TextBoxFor(m => m.recommendationReason, new { @class = "form-control", @row = "3", @placeholder = "Please type your reason here.", required = "required" })
                                                                        <div class="form-control-focus"> </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-actions" align="center">
                                                                <div class="row">
                                                                    <input id="clearAddGame" class="space btn grey" type="reset" value="Clear" />
                                                                    <button id="submitAddGamePatient" class="btn green btn-outline sbold uppercase" type="submit"><i class="fa fa-plus"></i> Add Game Based on Recommended Game Category for Patient</button>
                                                                </div>
                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                                <div class="portlet light portlet-fit ">
                                                    <div class="portlet-title">
                                                        <div class="caption">
                                                            <i class="fa fa-file-text-o font-red"></i>
                                                            <span class="caption-subject font-red sbold uppercase">Recommended Game via Game Assigned Dementia</span>
                                                        </div>
                                                    </div>
                                                    <div class="portlet-body">
                                                        @using (Html.BeginForm("AddRecommendGameForPatient", "GameTherapist", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                                                        {
                                                            @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                                                            <div class="table-scrollable table-scrollable-borderless">
                                                                <table class="table table-hover table-light">
                                                                    <thead>
                                                                        <tr class="uppercase">
                                                                            <th></th>
                                                                            <th><input type="checkbox" onclick="checkAllGame(this)" /> Select All</th>
                                                                            @foreach (var i in Model.diagnosedDementiaType)
                                                                            {
                                                                                <th> @i </th>
                                                                            }
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @foreach (var i in Model.gameAssignedToDementia.Select((value, index) => new { index, value }))
                                                                        {
                                                                            @Html.HiddenFor(m => m.assignNewGameViewModel[i.index].gameName, new { @Value = @Model.gameAssignedToDementia[i.index].game.gameName, @id = "gameName" + i.index })
                                                                            if (i.value.showGame == true)
                                                                            {
                                                                                <tr>
                                                                                    <td>@i.value.game.gameName <a class="fa fa-info-circle" data-toggle="desc" title="Categories: @i.value.categoryList"></a></td>
                                                                                    @if (i.value.gameAlreadyAssigned == true)
                                                                                    {
                                                                                        <td>@Html.CheckBoxFor(m => m.assignNewGameViewModel[i.index].gameChecked, new { @id = "oldGame" + i.index, @checked = "checked", @disabled = "disabled" })</td>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        @Html.HiddenFor(m => m.assignNewGameViewModel[i.index].gameID, new { @Value = @Model.gameAssignedToDementia[i.index].game.gameID, @id = "gameID" + i.index })
                                                                                        <td>@Html.CheckBoxFor(m => i.value.gameAlreadyAssigned, new { Name = "gameCheckBox", @id = "oldGame" + i.index, @checked = i.value.gameAlreadyAssigned })</td>
                                                                                        @:&nbsp;
                                                                                        @Html.HiddenFor(m => m.assignNewGameViewModel[i.index].gameChecked, new { @Value = "", @id = "newGame" + i.index })
                                                                                    }
                                                                                    @foreach (var j in i.value.bitString)
                                                                                    {
                                                                                        if (@j == "Yes")
                                                                                        {
                                                                                            <td><i class="fa fa-lg fa-check space text-success"></i></td>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td><i class="fa fa-lg fa-times space text-danger"></i></td>
                                                                                        }
                                                                                    }
                                                                                </tr>
                                                                            }
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <hr />
                                                            <div class="form-body">
                                                                <div class="form-group form-md-line-input has-success">
                                                                    <label class="col-md-2 control-label" for="form_control_1">End Date </label>
                                                                    <div class="col-md-10">
                                                                        @Html.TextBoxFor(m => m.gameCategoryEndDate, "dd/mm/yyyy", new { @class = "form-control date-picker", id = "datetimepicker3", @data_date_format = "dd/mm/yyyy" })
                                                                        <div class="form-control-focus"> </div>
                                                                        <span style="display: none; color:red;" id="gameCategoryDateError"></span>
                                                                    </div>
                                                                    <label class="col-md-2 control-label" for="form_control_1">Reason <a style="color:red; font-size:large">*</a></label>
                                                                    <div class="col-md-10">
                                                                        @Html.TextBoxFor(m => m.recommendationReason, new { @class = "form-control", @row = "3", @placeholder = "Please type your reason here.", required = "required" })
                                                                        <div class="form-control-focus"> </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-actions" align="center">
                                                                <div class="row">
                                                                    <input id="clearAddGame" class="space btn grey" type="reset" value="Clear" />
                                                                    <button id="submitAddGame" class="btn green btn-outline sbold uppercase" type="submit"><i class="fa fa-plus"></i> Add Game Based on Recommended Game </button>
                                                                </div>
                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                                <div class="portlet light portlet-fit ">
                                                    <div class="portlet-title">
                                                        <div class="caption">
                                                            <i class="fa fa-file-text-o font-red"></i>
                                                            <span class="caption-subject font-red sbold uppercase">Recommended Game Category via Game Category Assigned Dementia</span>
                                                        </div>
                                                    </div>
                                                    <div class="portlet-body">
                                                        @using (Html.BeginForm("AddRecommendGameCategoryForPatient", "GameTherapist", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                                                        {
                                                            @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                                                            var count = 0;
                                                            foreach (var i in Model.gameCategoryAssignedToDementia.Select((value, index) => new { index, value }))
                                                            {
                                                                <div class="portlet light portlet-fit ">
                                                                    <div class="portlet-title">
                                                                        <div class="caption">
                                                                            <i class="fa fa-file-text-o font-red"></i>
                                                                            <span class="caption-subject font-red sbold uppercase">@i.value.dementia</span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="portlet-body">
                                                                        <div class="table-scrollable table-scrollable-borderless">
                                                                            <table class="table table-hover table-light">
                                                                                <thead>
                                                                                    <tr class="uppercase">
                                                                                        <th></th>
                                                                                        <th><input type="checkbox" onclick="checkAllGameCategory(this, '@i.index')" /> Select All</th>
                                                                                        @for (int j = 0; j < Model.gameCategoryList.Count; j++)
                                                                                        {
                                                                                            <th>
                                                                                                @Model.gameCategoryList[j]
                                                                                                @if (i.value.recommendedCategory[j] == "Yes")
                                                                                                {
                                                                                                    <i class="fa fa-thumbs-up fa fa-lg space text-success"></i>
                                                                                                }
                                                                                            </th>
                                                                                        }
                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody>
                                                                                    @foreach (var j in i.value.viewModel.Select((value, index) => new { index, value }))
                                                                                    {
                                                                                        @Html.HiddenFor(m => m.assignNewGameCategoryViewModel[count].gameName, new { @Value = @i.value.viewModel[j.index].game.gameName, @id = "gameName" + count })
                                                                                        if (j.value.showGame == true)
                                                                                        {
                                                                                            <tr>
                                                                                                <td>@j.value.game.gameName <a class="fa fa-info-circle" data-toggle="desc" title="Categories: @j.value.categoryList"></a></td>
                                                                                                @if (j.value.gameAlreadyAssigned == true)
                                                                                                {
                                                                                                    <td>@Html.CheckBoxFor(m => m.assignNewGameCategoryViewModel[count].gameChecked, new { @id = "oldGameCategory" + count, @checked = "checked", @disabled = "disabled" })</td>
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    @Html.HiddenFor(m => m.assignNewGameCategoryViewModel[count].gameID, new { @Value = @i.value.viewModel[j.index].game.gameID, @id = "gameCategoryID" + count })
                                                                                                    <td>@Html.CheckBoxFor(m => j.value.gameAlreadyAssigned, new { Name = "gameCategoryCheckBox" + i.index, @id = "oldGameCategory" + count, @checked = j.value.gameAlreadyAssigned })</td>
                                                                                                    @:&nbsp;
                                                                                                    @Html.HiddenFor(m => m.assignNewGameCategoryViewModel[count].gameChecked, new { @Value = "", @id = "newGameCategory" + count })
                                                                                                }
                                                                                                @foreach (var k in j.value.categoryBitString)
                                                                                                {
                                                                                                    if (@k == "Yes")
                                                                                                    {
                                                                                                        <td><i class="fa fa-lg fa-check space text-success"></i></td>
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        <td><i class="fa fa-lg fa-times space text-danger"></i></td>
                                                                                                    }
                                                                                                }
                                                                                            </tr>
                                                                                        }
                                                                                        count++;
                                                                                    }
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            }
                                                            <hr />
                                                            <div class="form-body">
                                                                <div class="form-group form-md-line-input has-success">
                                                                    <label class="col-md-2 control-label" for="form_control_1">End Date </label>
                                                                    <div class="col-md-10">
                                                                        @Html.TextBoxFor(m => m.gameCategoryEndDate, "dd/mm/yyyy", new { @class = "form-control date-picker", id = "datetimepicker3", @data_date_format = "dd/mm/yyyy" })
                                                                        <div class="form-control-focus"> </div>
                                                                        <span style="display: none; color:red;" id="gameCategoryDateError"></span>
                                                                    </div>
                                                                    <label class="col-md-2 control-label" for="form_control_1">Reason <a style="color:red; font-size:large">*</a></label>
                                                                    <div class="col-md-10">
                                                                        @Html.TextBoxFor(m => m.recommendationReason, new { @class = "form-control", @row = "3", @placeholder = "Please type your reason here.", required = "required" })
                                                                        <div class="form-control-focus"> </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-actions" align="center">
                                                                <div class="row">
                                                                    <input id="clearAddGame" class="space btn grey" type="reset" value="Clear" />
                                                                    <button id="submitAddGameCategory" class="btn green btn-outline sbold uppercase" type="submit"><i class="fa fa-plus"></i> Add Game Based on Recommended Game Category </button>
                                                                </div>
                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>  
            </div>
        </div>
    </div>
</div>

<div class="modal" id="MyModal1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            @using (Html.BeginForm("Delete", "GameTherapist", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
            {
                @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                @Html.HiddenFor(p => p.tableName, new { @Value = "", @id = "tableName" })
                @Html.HiddenFor(p => p.itemID, new { @Value = "", @id = "itemID" })

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4>Delete Confirm Message</h4>
                </div>
                <div class="modal-body" align="center">
                    <p>Are you sure you want to delete this item?</p>
                </div>
                <div class="form-group" align="center">
                    <div class="col-md-5">
                        Reason for deleting record<a style="color:red; font-size:large">*</a>
                    </div>
                    <div class="col-md-6">
                        @Html.TextBoxFor(p => p.deleteReason, new { @class = "form-control", required = "required" })
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default grey" data-dismiss="modal">Cancel</button>
                    <input id="submit" type="submit" class="space btn btn-primary" value="Delete" />
                </div>
            }
        </div>
    </div>
</div>

<!-- The Modal/Lightbox -->
<div id="myModal" class="modal2">
    <span class="close2 cursor" onclick="closeModal()">&times;</span>
    <div class="modal2-content">
        <img src="" id="img" style="width:100%">
    </div>
    <!-- Caption text -->
    <div class="caption-container">
        <p id="caption"></p>
    </div>
</div>

<div class="modal fade" id="addAssignedGame">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                @using (Html.BeginForm("AddGameRecommended", "GameTherapist", new { @class = "form-horizontal" }))
                {
                    @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4>Add Game</h4>
                    </div>
                    <div class="form-body">
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Game<a style="color:red; font-size:large">*</a></label>
                                <div class="col-md-8">
                                    @Html.DropDownList("game", null, new { @class = "form-control" })
                                    <div class="form-control-focus"> </div>
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">End Date</label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.gameCategoryEndDate, "dd/mm/yyyy", new { @class = "form-control date-picker", id = "datetimepicker3", @data_date_format = "dd/mm/yyyy" })
                                    <div class="form-control-focus"> </div>
                                    <span style="display: none; color:red;" id="gameCategoryDateError"></span>
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Recommendation Reason<a style="color:red; font-size:large">*</a></label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.recommendationReason, new { @class = "form-control", @row = "3", @placeholder = "Please type your reason here.", required = "required" })
                                    <div class="form-control-focus"> </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions" align="center">
                        <div class="row">
                            <button type="button" data-dismiss="modal" class="btn default">Cancel</button>
                            <button id="submit" type="submit" class="btn blue">Submit</button>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="addGameCategoryRecommended">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                @using (Html.BeginForm("AddGameRecommended", "GameTherapist", new { @class = "form-horizontal" }))
                {
                    @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4>Recommend Game Category</h4>
                    </div>
                    <div class="form-body">
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Game Category<a style="color:red; font-size:large">*</a></label>
                                <div class="col-md-8">
                                    @Html.DropDownList("gameCategory", null, new { @class = "form-control" })
                                    <div class="form-control-focus"> </div>
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Start Date<a style="color:red; font-size:large">*</a></label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.gameCategoryStartDate, "dd/mm/yyyy", new { @class = "form-control date-picker", id = "datetimepicker1", @data_date_format = "dd/mm/yyyy", required = "required" })
                                    <div class="form-control-focus"> </div>
                                    <span style="display: none; color:red;" id="startDateError"></span>
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">End Date</label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.gameCategoryEndDate, "dd/mm/yyyy", new { @class = "form-control date-picker", id = "datetimepicker2", @data_date_format = "dd/mm/yyyy" })
                                    <div class="form-control-focus"> </div>
                                    <span style="display: none; color:red;" id="endDateError"></span>
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Recommendation Reason<a style="color:red; font-size:large">*</a></label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.recommendationReason, new { @class = "form-control", @row = "3", @placeholder = "Please type your reason here.", required = "required" })
                                    <div class="form-control-focus"> </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions" align="center">
                        <div class="row">
                            <button type="button" data-dismiss="modal" class="btn default">Cancel</button>
                            <button id="submit" type="submit" class="btn blue">Submit</button>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="MyModal2">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                @using (Html.BeginForm("ManageGameTypeRecommendation", "GameTherapist", new { @class = "form-horizontal" }))
                {
                    @Html.HiddenFor(p => p.patientID, new { @Value = @Model.patientID, @id = "ab" })
                    @Html.HiddenFor(p => p.itemID, new { @Value = "", @id = "itemID2" })

                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4>Approve/Reject Game Recommended by Doctor</h4>
                    </div>
                    <div class="form-body">
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Game Category</label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.gameCategory, new { @class = "form-control", @id = "gameCategory2", @Value = "", @row = "3", @disabled = "disabled" })
                                    <div class="form-control-focus"> </div>
                                </div>
                                <label class="col-md-4 control-label" for="form_control_1">End Date</label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.gameCategoryEndDate, new { @class = "form-control", @id = "gameCategoryEndDate2", @row = "3", @disabled = "disabled" })
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Doctor Name</label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.doctorName, new { @class = "form-control", @id = "doctorName2", @row = "3", @disabled = "disabled" })
                                </div>
                                <label class="col-md-4 control-label" for="form_control_1">Recommendation Reason</label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.recommendationReason, new { @class = "form-control", @id = "recommendationReason2", @row = "3", @disabled = "disabled" })
                                </div>
                            </div>
                        </div>
                        <div class="well">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Game title</label>
                                <div class="col-md-8" id="approved" type="radio">
                                    @Html.RadioButtonFor(m => m.isApproved, "1", new { @id = "option1", @checked = "checked" })@Html.Label("Approve")
                                    &nbsp;
                                    @Html.RadioButtonFor(m => m.isApproved, "0", new { @id = "option2" })@Html.Label("Reject")
                                </div>
                            </div>
                        </div>
                        <div class="well" id="showRejectReason" style="display:none">
                            <div class="form-group form-md-line-input has-success">
                                <label class="col-md-4 control-label" for="form_control_1">Rejection Reason<a style="color:red; font-size:large">*</a></label>
                                <div class="col-md-8">
                                    @Html.TextBoxFor(m => m.rejectionReason, new { @class = "form-control", @id = "rejectionReason", @row = "3" })
                                    <span style="display: block; color:red;" id="rejectionError"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions" align="center">
                        <div class="row">
                            <button type="button" data-dismiss="modal" class="btn default">Cancel</button>
                            <button id="submitGameTypeRecommendation" type="submit" class="btn blue">Submit</button>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<link href="~/Content/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/pages/css/profile-2.min.css" rel="stylesheet" type="text/css" />
<script src="~/Content/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/js.cookie.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>

<script src="~/Content/global/plugins/moment.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/bootstrap-daterangepicker/daterangepicker.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<script src="~/Content/global/plugins/clockface/js/clockface.js" type="text/javascript"></script>
<script src="~/Content/global/scripts/app.min.js" type="text/javascript"></script>
<script src="~/Content/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>

<link rel="stylesheet" href="~/Content/global/css/jquery.timepicker.css" type="text/css" />
<script src="~/Content/global/scripts/jquery.timepicker.js" type="text/javascript"></script>

@*Input Checks*@
<script src="~/Content/global/scripts/inputChecks.js" type="text/javascript"></script>

<script>
    $(document).ready(function () {
        $('[data-toggle="desc"]').tooltip();
        $(".date-picker").datepicker("setDate", null);      // DD-MM-YYYY

        $('#datetimepicker1').change(function () {
            dateCheck();
        });

        $('#datetimepicker2').change(function () {
            dateCheck();
        });

        $('#datetimepicker3').change(function () {
            dateCheck3();
        });

        function dateCheck() {
            console.log("dateCheckstart");
            var datetimepicker1Val = $("#datetimepicker1").val();
            var datetimepicker2Val = $("#datetimepicker2").val();

            var datetime = new Date();
            var dd = datetime.getDate();
            var mm = datetime.getMonth() + 1; //January is 0!

            var yyyy = datetime.getFullYear();
            if (dd < 10) {
                dd = '0' + dd;
            }
            if (mm < 10) {
                mm = '0' + mm;
            }
            var d = dd + '/' + mm + '/' + yyyy;


            var arrStartDate = datetimepicker1Val.split("/");
            var stdate = new Date(arrStartDate[2], arrStartDate[1], arrStartDate[0]);

            var arrEndDate = datetimepicker2Val.split("/");
            var enddate = new Date(arrEndDate[2], arrEndDate[1], arrEndDate[0]);


            var arrCrDate = d.split("/");
            var tdate = new Date(arrCrDate[2], arrCrDate[1], arrCrDate[0]);

            if (enddate < tdate) {
                document.getElementById("endDateError").innerHTML = "End date cannot be before today.";
                document.getElementById("endDateError").style.display = "block";

            } else {
                document.getElementById("endDateError").innerHTML = "";
                document.getElementById("endDateError").style.display = "none";
            }

            if (stdate < tdate) {
                document.getElementById("startDateError").innerHTML = "Start date cannot be before today.";
                document.getElementById("startDateError").style.display = "block";
                return false;

            } else {
                document.getElementById("startDateError").innerHTML = "";
                document.getElementById("startDateError").style.display = "none";
            }

            if (stdate > enddate && enddate != "") {
                document.getElementById("startDateError").innerHTML = "Start date cannot be after end date.";
                document.getElementById("startDateError").style.display = "block";
                return false;

            } else {
                document.getElementById("startDateError").innerHTML = "";
                document.getElementById("startDateError").style.display = "none";
            }


            if (enddate < tdate && stdate != "") {
                document.getElementById("endDateError").innerHTML = "End date cannot be before today.";
                document.getElementById("endDateError").style.display = "block";
                return false;

            } else {
                document.getElementById("endDateError").innerHTML = "";
                document.getElementById("endDateError").style.display = "none";
            }
            console.log("dateCheckend");
            return true;
        }

        function dateCheck3() {
            var datetimepicker3Val = $("#datetimepicker3").val();

            var datetime = new Date();
            var dd = datetime.getDate();
            var mm = datetime.getMonth() + 1; //January is 0!

            var yyyy = datetime.getFullYear();
            if (dd < 10) {
                dd = '0' + dd;
            }
            if (mm < 10) {
                mm = '0' + mm;
            }
            var d = dd + '/' + mm + '/' + yyyy;

            var arrStartDate = datetimepicker3Val.split("/");
            var stdate = new Date(arrStartDate[2], arrStartDate[1], arrStartDate[0]);

            var arrCrDate = d.split("/");
            var tdate = new Date(arrCrDate[2], arrCrDate[1], arrCrDate[0]);

            if (stdate < tdate) {
                document.getElementById("gameCategoryDateError").innerHTML = "End date cannot be before today.";
                document.getElementById("gameCategoryDateError").style.display = "block";
                return false;

            } else {
                document.getElementById("gameCategoryDateError").innerHTML = "";
                document.getElementById("gameCategoryDateError").style.display = "none";
            }
            return true;
        }
    });

    function OpenModalPopUp(itemID) {
        document.getElementById('itemID').value = itemID;
    };

    function OpenModalApproveReject(gameCategory, doctorName, gameCategoryEndDate, recommendationReason, itemID) {
        document.getElementById('gameCategory2').value = gameCategory;
        document.getElementById('doctorName2').value = doctorName;
        document.getElementById('gameCategoryEndDate2').value = gameCategoryEndDate;
        document.getElementById('recommendationReason2').value = recommendationReason;
        document.getElementById('itemID2').value = itemID;
    };

    $(function () {
        var approved = $('#approved');
        var element = document.getElementById('showRejectReason');
        //var element2 = document.getElementById('showComment');

        approved.on('change', function () {
            if (document.getElementById("option2").checked) {
                element.style.display = 'block';
                //element2.style.display = 'none';
            }
            else {
                element.style.display = 'none';
                //element2.style.display = 'block';
            }
        }).trigger('change');
    });

    $('#submitGameTypeRecommendation').click(function () {
        var rejectionReason = document.getElementById('rejectionReason');
        var rejectionError = document.getElementById('rejectionError');

        if (document.getElementById("option2").checked && (rejectionReason.value == null || rejectionReason.value == "")) {
            document.getElementById('rejectionError').innerHTML = "Please specify the reason for rejecting.";
            document.getElementById('rejectionError').style.display = "block";
            return false;
        }

        return true;
    });

    $('#submitAddGamePatient').click(function () {
        for (var i = 0; i < @Model.gameAssignedPatientViewModel.viewModel.Count; i++) {
            if (document.getElementById('gamePatientID' + i.toString()) != null) {
                if (document.getElementById('oldGamePatient' + i.toString()).checked)
                    document.getElementById('newGamePatient' + i.toString()).value = true;
                else
                    document.getElementById('newGamePatient' + i.toString()).value = false;
            }
        }
        return true;
    });

    $('#submitAddGame').click(function () {
        for (var i = 0; i < @Model.gameAssignedToDementia.Count; i++) {
            if (document.getElementById('gameID' + i.toString()) != null) {
                if (document.getElementById('oldGame' + i.toString()).checked)
                    document.getElementById('newGame' + i.toString()).value = true;
                else
                    document.getElementById('newGame' + i.toString()).value = false;
            }
        }
        return true;
    });

    $('#submitAddGameCategory').click(function () {
        @{
            var counter = 0;
            for (var i = 0; i < Model.gameCategoryAssignedToDementia.Count(); i++) {
                counter += Model.gameCategoryAssignedToDementia.ToList()[i].viewModel.Count;
            }
        }

        for (var i = 0; i < @counter; i++) {
            if (document.getElementById('gameCategoryID' + i.toString()) != null) {
                if (document.getElementById('oldGameCategory' + i.toString()).checked)
                    document.getElementById('newGameCategory' + i.toString()).value = true;
                else
                    document.getElementById('newGameCategory' + i.toString()).value = false;
            }
        }
        return true;
    });

    function checkAllGamePatient(source) {
        checkboxes = document.getElementsByName('gamePatientCheckBox');
        for (var i = 0; i < checkboxes.length; i++)
            checkboxes[i].checked = source.checked;
    }

    function checkAllGame(source) {
        checkboxes = document.getElementsByName('gameCheckBox');
        for (var i = 0; i < checkboxes.length; i++)
            checkboxes[i].checked = source.checked;
    }

    function checkAllGameCategory(source, index) {
        checkboxes = document.getElementsByName('gameCategoryCheckBox' + index);
        for (var i = 0; i < checkboxes.length; i++)
            checkboxes[i].checked = source.checked;
    }
</script>